# Created by Danny Tsang <danny@tsang.uk>
conservatory_camera_process_image:
  alias: Conservatory Camera Process Image
  fields:
    message:
      description: Message to post
    title:
      description: Header to the message posted.
  sequence:
    - service: image_processing.scan
      target:
        entity_id: image_processing.deepstack_object_conservatory
    - delay:
        hours: 0
        minutes: 0
        seconds: 10
        milliseconds: 0
    - choose:
        - conditions:
            - condition: numeric_state
              entity_id: image_processing.deepstack_object_conservatory
              above: "0"
          sequence:
            - service: shell_command.copy_conservatory_deepstack_files
            - service: script.post_to_home_log_with_local_attachments
              data:
                title: "{{ title }}"
                message: "{{ message }}"
                filePath: "{{states('input_text.camera_external_folder_path')}}/conservatory/deepstack_object_conservatory_latest.png"
      default: []
  mode: single
  icon: mdi:camera
