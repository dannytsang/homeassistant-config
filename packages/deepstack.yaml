# Created by Danny Tsang <danny@tsang.uk>
image_processing:
  - platform: deepstack_object
    ip_address: !secret deepstack_host
    port: 5000
    timeout: 20
    api_key: !secret deepstack_api_key
    save_file_folder: !secret image_processing_conservatory
    save_file_format: png
    save_timestamped_file: True
    always_save_latest_file: True
    scale: 0.75
    #roi_x_min: 0.35
    #roi_x_max: 0.8
    #roi_y_min: 0.4
    #roi_y_max: 0.8
    targets:
      - target: person
        confidence: 30
      - target: cat
        confidence: 50
      - target: dog
        confidence: 50
      - target: knife
        confidence: 25
    source:
      - entity_id: camera.conservatory
  - platform: deepstack_object
    ip_address: !secret deepstack_host
    port: 5000
    timeout: 20
    api_key: !secret deepstack_api_key
    save_file_folder: !secret image_processing_driveway
    save_file_format: png
    save_timestamped_file: True
    always_save_latest_file: True
    scale: 0.75
    #roi_x_min: 0.35
    #roi_x_max: 0.8
    #roi_y_min: 0.4
    #roi_y_max: 0.8
    targets:
      - target: person
      - target: vehicle
        confidence: 60
      - target: car
        confidence: 40
    source:
      - entity_id: camera.driveway
  - platform: deepstack_object
    ip_address: !secret deepstack_host
    port: 5000
    timeout: 20
    api_key: !secret deepstack_api_key
    save_file_folder: !secret image_processing_front_door
    save_file_format: png
    save_timestamped_file: True
    always_save_latest_file: True
    scale: 0.75
    #roi_x_min: 0.35
    #roi_x_max: 0.8
    #roi_y_min: 0.4
    #roi_y_max: 0.8
    targets:
      - target: person
        confidence: 40
      - target: cat
        confidence: 75
      - target: dog
        confidence: 75
      - target: knife
        confidence: 50
    source:
      - entity_id: camera.front_door
  - platform: deepstack_object
    ip_address: !secret deepstack_host
    port: 5000
    timeout: 20
    api_key: !secret deepstack_api_key
    save_file_folder: !secret image_processing_lounge
    save_file_format: png
    save_timestamped_file: True
    always_save_latest_file: True
    scale: 0.75
    #roi_x_min: 0.35
    #roi_x_max: 0.8
    #roi_y_min: 0.4
    #roi_y_max: 0.8
    targets:
      - target: person
        confidence: 25
      - target: cat
        confidence: 50
      - target: dog
        confidence: 50
      - target: knife
        confidence: 25
    source:
      - entity_id: camera.lounge
  - platform: deepstack_object
    ip_address: !secret deepstack_host
    port: 5000
    timeout: 20
    api_key: !secret deepstack_api_key
    save_file_folder: !secret image_processing_upstairs
    save_file_format: png
    save_timestamped_file: True
    always_save_latest_file: True
    scale: 0.75
    #roi_x_min: 0.35
    #roi_x_max: 0.8
    #roi_y_min: 0.4
    #roi_y_max: 0.8
    targets:
      - target: person
        confidence: 40
      - target: cat
        confidence: 50
      - target: dog
        confidence: 50
      - target: knife
        confidence: 25
    source:
      - entity_id: camera.upstairs
shell_command:
  copy_conservatory_deepstack_files: !secret copy_conservatory_deepstack_files_command
  copy_driveway_deepstack_files: !secret copy_driveway_deepstack_files_command
  copy_front_door_deepstack_files: !secret copy_front_door_deepstack_files_command
  copy_lounge_deepstack_files: !secret copy_lounge_deepstack_files_command
  copy_upstairs_deepstack_files: !secret copy_upstairs_deepstack_files_command
