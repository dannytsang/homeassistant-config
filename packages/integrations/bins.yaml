# Created by Danny Tsang <danny@tsang.uk>
input_boolean:
  enable_bin_collection_notifications:
    name: Enable Bin Collection Notifications

input_number:
  bin_collection_notification_start_offset:
    name: Bin Collection Notification Start Offset
    unit_of_measurement: hours
    min: 0
    max: 24
  bin_collection_notification_end_offset:
    name: Bin Collection Notification End Offset
    unit_of_measurement: hours
    min: -24
    max: 0

template:
  - binary_sensor:
      - name: Bin Collection Due
        state: >
          {{ (as_timestamp(state_attr('calendar.bins', 'start_time')) - as_timestamp(now())) <= (states('input_number.bin_collection_notification_start_offset')|int(0)*60*60) 
          and (as_timestamp(state_attr('calendar.bins', 'end_time')) - as_timestamp(now())) >= ((states('input_number.bin_collection_notification_end_offset')|int(0)*60*60)|abs) }}
