# Created by Danny Tsang <danny@tsang.uk>
# Integration: https://www.home-assistant.io/integrations/hyperion/
script:
  hyperion_notification:
    alias: Hyperion Based Notification
    fields:
      entity_id:
        description: Entity ID of the media player.
        required: true
      display_state:
        description: The friendly state in text.
        required: true
        example: "'turned on', 'paused', etc"
    variables:
      title: >-
        {% if entity_id|default('', true) == 'media_player.lounge_tv' %}
        :couch_and_lamp: Lounge
        {% elif entity_id|default('', true) == 'media_player.bedroom_tv' %}
        :bed: Bedroom
        {% else %}
        :warning: Unknown device {{ entity_id }}
        {% endif%}
      device: >-
        {% if entity_id|default('', true) in ()'media_player.lounge_tv', 'media_player.bedroom_tv') %}
        Google TV
        {% else %}
        Unknown device {{ entity_id }}
        {% endif%}
      file_path: "{{ states('input_text.latest_hyperion_lounge_tv_file_path') if entity_id|default('', true) == 'media_player.lounge_tv' else states('input_text.latest_hyperion_bedroom_tv_file_path') }}"
    sequence:
      - delay:
          seconds: 2
      - service: script.send_home_log_with_local_attachments
        data:
          message: "{{ device }} {{ display_state }}."
          title: "{{ title }}"
          filePath: "{{ states('input_text.camera_external_folder_path') }}{{ file_path }}"
    mode: queued
    max: 10
