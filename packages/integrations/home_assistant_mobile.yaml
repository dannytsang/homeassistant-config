# Created by Danny Tsang <danny@tsang.uk>
script:
  post_home_assistant_direct_notification:
    alias: "Send Home Assistant Direct Message"
    icon: mdi:message-reply-text
    description: >-
      Post a direct text message to adults in the house. Please use
      a send script to decouple from the messaging platform.
    fields:
      message:
        description: Message to post
        required: true
        selector:
          text:
            multiline: true
      title:
        description: Title of post
        selector:
          text:
      people:
        description: Person to send the message to.
          If not specified then it goes to everyone.
        example: "['person.danny'] or ['person.danny','person.terina']"
        selector:
          target:
            entity:
              domain:
                - person
      priority:
        description: Determines the importance of the notification.
          Higher the importance, the more likely it will alert the user even when in silent mode.
        example: "high, medium, low"
        default: "medium"
        selector:
          select:
            options:
              - high
              - medium
              - low
    sequence:
      - choose:
          - conditions:
              - condition: template
                value_template: "{{ 'person.danny' in people }}"
            sequence:
              - service: notify.mobile_app_danny_s_phone
                data:
                  message: "{{ message }}"
                  title: "{{ title|default('', true) }}"
                continue_on_error: true
          - conditions:
              - condition: template
                value_template: "{{ 'person.terina' in people }}"
            sequence:
              - service: notify.mobile_app_danny_s_phone
                data:
                  message: "{{ message }}"
                  title: "{{ title|default('', true) }}"
                continue_on_error: true
              - service: notify.mobile_app_terina_s_phone
                data:
                  message: "{{ message }}"
                  title: "{{ title|default('', true) }}"
                continue_on_error: true
          - conditions:
              - condition: template
                value_template: "{{ 'person.leo' in people }}"
            sequence:
              - service: notify.mobile_app_ipad_air_4th_generation
                data:
                  message: "{{ message }}"
                  title: "{{ title|default(none, true) }}"
                continue_on_error: true
        default:
          - parallel:
              - service: notify.mobile_app_danny_s_phone
                data:
                  message: "{{ message }}"
                  title: "{{ title|default('', true) }}"
                continue_on_error: true
              - service: notify.mobile_app_terina_s_phone
                data:
                  message: "{{ message }}"
                  title: "{{ title|default('', true) }}"
                continue_on_error: true
              - service: notify.mobile_app_ipad_air_4th_generation
                data:
                  message: "{{ message }}"
                  title: "{{ title|default(none, true) }}"
                continue_on_error: true
    mode: queued
    max: 10
  post_to_home_assistant_with_url_attachment:
    alias: "Post To Home Assistant App With File Or URL Attachments"
    icon: mdi:message-image
    description: >-
      Post a message with a file or URL attachment to the home_log
      channel. Only a file or URL can be set. Not both or neither. Please use a
      send script to decouple from the messaging platform."
    fields:
      message:
        description: Message to post
        required: true
        selector:
          text:
            multiline: true
      title:
        description: (optional)Title to the message posted.
        selector:
          text:
      people:
        description: People to message.
          If not specified then it goes to everyone.
        example: "['person.danny'] or ['person.danny','person.terina']"
        selector:
          target:
            entity:
              domain:
                - person
      url:
        description: Link to file.
        example: "https://picsum.photos/200/300"
        selector:
          text:
            type: "url"
      url_type:
        description: >-
          The type of resource the URL referes to. Audio is only supported by iOS.
          More details can found at https://companion.home-assistant.io/docs/notifications/notification-attachments
        example: image
        required: true
        selector:
          select:
            options:
              - audio
              - image
              - video
              - web
      priority:
        description: Determines the importance of the notification.
          Higher the importance, the more likely it will alert the user even when in silent mode.
        example: "high, medium, low"
        default: "medium"
        selector:
          select:
            options:
              - high
              - medium
              - low
    sequence:
      - choose:
          - conditions:
              - condition: template
                value_template: "{{ url_type == 'audio' }}"
            sequence:
              - choose:
                  - conditions:
                      - condition: template
                        value_template: "{{ 'person.leo' in people }}"
                    sequence:
                      - service: notify.mobile_app_ipad_air_4th_generation
                        data:
                          message: "{{ message }}"
                          title: "{{ title|default('', true) }}"
                          data:
                            audio: "{{ url }}"
                            priority: "{{ priority|default('medium', true) }}"
                        continue_on_error: true
                default:
                  - parallel:
                      - service: notify.mobile_app_ipad_air_4th_generation
                        data:
                          message: "{{ message }}"
                          title: "{{ title|default('', true) }}"
                          data:
                            audio: "{{ url }}"
                            priority: "{{ priority|default('medium', true) }}"
                        continue_on_error: true
          - conditions:
              - condition: template
                value_template: "{{ url_type == 'image' }}"
            sequence:
              - choose:
                  - conditions:
                      - condition: template
                        value_template: "{{ 'person.danny' in people }}"
                    sequence:
                      - service: notify.mobile_app_danny_s_phone
                        data:
                          message: "{{ message }}"
                          title: "{{ title|default('', true) }}"
                          data:
                            image: "{{ url }}"
                            priority: "{{ priority|default('medium', true) }}"
                        continue_on_error: true
                  - conditions:
                      - condition: template
                        value_template: "{{ 'person.terina' in people }}"
                    sequence:
                      - service: notify.mobile_app_terina_s_phone
                        data:
                          message: "{{ message }}"
                          title: "{{ title|default('', true) }}"
                          data:
                            image: "{{ url }}"
                            priority: "{{ priority|default('medium', true) }}"
                        continue_on_error: true
                  - conditions:
                      - condition: template
                        value_template: "{{ 'person.leo' in people }}"
                    sequence:
                      - service: notify.mobile_app_ipad_air_4th_generation
                        data:
                          message: "{{ message }}"
                          title: "{{ title|default('', true) }}"
                          data:
                            image: "{{ url }}"
                            priority: "{{ priority|default('medium', true) }}"
                        continue_on_error: true
                default:
                  - parallel:
                      - service: notify.mobile_app_danny_s_phone
                        data:
                          message: "{{ message }}"
                          title: "{{ title|default('', true) }}"
                          data:
                            image: "{{ url }}"
                            priority: "{{ priority|default('medium', true) }}"
                        continue_on_error: true
                      - service: notify.mobile_app_terina_s_phone
                        data:
                          message: "{{ message }}"
                          title: "{{ title|default('', true) }}"
                          data:
                            image: "{{ url }}"
                            priority: "{{ priority|default('medium', true) }}"
                        continue_on_error: true
                      - service: notify.mobile_app_ipad_air_4th_generation
                        data:
                          message: "{{ message }}"
                          title: "{{ title|default('', true) }}"
                          data:
                            image: "{{ url }}"
                            priority: "{{ priority|default('medium', true) }}"
                        continue_on_error: true
          - conditions:
              - condition: template
                value_template: "{{ url_type == 'video' }}"
            sequence:
              - choose:
                  - conditions:
                      - condition: template
                        value_template: "{{ 'person.danny' in people }}"
                    sequence:
                      - service: notify.mobile_app_danny_s_phone
                        data:
                          message: "{{ message }}"
                          title: "{{ title|default('', true) }}"
                          data:
                            image: "{{ url }}"
                            priority: "{{ priority|default('medium', true) }}"
                        continue_on_error: true
                  - conditions:
                      - condition: template
                        value_template: "{{ 'person.terina' in people }}"
                    sequence:
                      - service: notify.mobile_app_terina_s_phone
                        data:
                          message: "{{ message }}"
                          title: "{{ title|default('', true) }}"
                          data:
                            image: "{{ url }}"
                            priority: "{{ priority|default('medium', true) }}"
                        continue_on_error: true
                  - conditions:
                      - condition: template
                        value_template: "{{ 'person.leo' in people }}"
                    sequence:
                      - service: notify.mobile_app_ipad_air_4th_generation
                        data:
                          message: "{{ message }}"
                          title: "{{ title|default('', true) }}"
                          data:
                            image: "{{ url }}"
                            priority: "{{ priority|default('medium', true) }}"
                        continue_on_error: true
                default:
                  - parallel:
                      - service: notify.mobile_app_danny_s_phone
                        data:
                          message: "{{ message }}"
                          title: "{{ title|default('', true) }}"
                          data:
                            image: "{{ url }}"
                            priority: "{{ priority|default('medium', true) }}"
                        continue_on_error: true
                      - service: notify.mobile_app_terina_s_phone
                        data:
                          message: "{{ message }}"
                          title: "{{ title|default('', true) }}"
                          data:
                            image: "{{ url }}"
                            priority: "{{ priority|default('medium', true) }}"
                        continue_on_error: true
                      - service: notify.mobile_app_ipad_air_4th_generation
                        data:
                          message: "{{ message }}"
                          title: "{{ title|default('', true) }}"
                          data:
                            image: "{{ url }}"
                            priority: "{{ priority|default('medium', true) }}"
                        continue_on_error: true
        default:
          - choose:
              - conditions:
                  - condition: template
                    value_template: "{{ 'person.danny' in people }}"
                sequence:
                  - service: notify.mobile_app_danny_s_phone
                    data:
                      message: "{{ message }}"
                      title: "{{ title|default('', true) }}"
                      data:
                        clickAction: "{{ url }}"
                        priority: "{{ priority|default('medium', true) }}"
                    continue_on_error: true
              - conditions:
                  - condition: template
                    value_template: "{{ 'person.terina' in people }}"
                sequence:
                  - service: notify.mobile_app_terina_s_phone
                    data:
                      message: "{{ message }}"
                      title: "{{ title|default('', true) }}"
                      data:
                        clickAction: "{{ url }}"
                        priority: "{{ priority|default('medium', true) }}"
                    continue_on_error: true
              - conditions:
                  - condition: template
                    value_template: "{{ 'person.leo' in people }}"
                sequence:
                  - service: notify.mobile_app_ipad_air_4th_generation
                    data:
                      message: "{{ message }}"
                      title: "{{ title|default('', true) }}"
                      data:
                        url: "{{ url }}"
                        priority: "{{ priority|default('medium', true) }}"
                    continue_on_error: true
            default:
              - parallel:
                  - service: notify.mobile_app_danny_s_phone
                    data:
                      message: "{{ message }}"
                      title: "{{ title|default('', true) }}"
                      data:
                        clickAction: "{{ url }}"
                        priority: "{{ priority|default('medium', true) }}"
                    continue_on_error: true
                  - service: notify.mobile_app_terina_s_phone
                    data:
                      message: "{{ message }}"
                      title: "{{ title|default('', true) }}"
                      data:
                        clickAction: "{{ url }}"
                        priority: "{{ priority|default('medium', true) }}"
                    continue_on_error: true
                  - service: notify.mobile_app_ipad_air_4th_generation
                    data:
                      message: "{{ message }}"
                      title: "{{ title|default('', true) }}"
                      data:
                        url: "{{ url }}"
                        priority: "{{ priority|default('medium', true) }}"
                    continue_on_error: true
    mode: queued
    max: 10
